<!DOCTYPE html>
<html>
<head>
<title>LiveSense Vision Dashboard</title>
<meta charset="UTF-8">
<style>
body {
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
  background:linear-gradient(135deg,#0f172a,#1e293b);
  color:#f8fafc;
}
.wrapper {
  max-width:1000px;
  margin:60px auto;
  padding:20px;
}
h1 span { color:#38bdf8; }
.card {
  background:rgba(255,255,255,0.05);
  backdrop-filter:blur(14px);
  border-radius:20px;
  padding:30px;
  box-shadow:0 20px 60px rgba(0,0,0,0.4);
}
.status {
  display:flex;
  justify-content:space-between;
  margin-bottom:20px;
}
.online { color:#22c55e; }
.offline { color:#ef4444; }
.event {
  background:#0f172a;
  padding:15px;
  border-radius:12px;
  margin-bottom:12px;
}
button {
  padding:8px 16px;
  border-radius:8px;
  border:none;
  cursor:pointer;
  margin-right:8px;
}
.start { background:#38bdf8; }
.stop { background:#ef4444; color:white; }
</style>
</head>

<body>
<div class="wrapper">
<h1>Live<span>Sense</span> Vision Dashboard</h1>

<div class="card">
<div class="status">
<div id="conn" class="offline">Backend: Disconnected</div>
<div>Total Events: <span id="count">0</span></div>
</div>

<button class="start" onclick="start()">Start</button>
<button class="stop" onclick="stop()">Stop</button>

<div id="events"></div>
</div>
</div>

<script>
let timer=null;
const URL="http://localhost:8080/vision/events";

async function fetchEvents(){
 try{
   const res=await fetch(URL);
   const data=await res.json();

   document.getElementById("conn").innerText="Backend: Connected";
   document.getElementById("conn").className="online";
   document.getElementById("count").innerText=data.length;

   const container=document.getElementById("events");
   container.innerHTML="";

   data.slice().reverse().forEach(e=>{
     const div=document.createElement("div");
     div.className="event";
     div.innerHTML=
       "<strong>"+e.eventType+"</strong><br>"+
       "Confidence: "+e.confidence.toFixed(2)+"<br>"+
       "Camera: "+e.cameraId+"<br>"+
       "Time: "+e.timestamp;
     container.appendChild(div);
   });

 }catch{
   document.getElementById("conn").innerText="Backend: Disconnected";
   document.getElementById("conn").className="offline";
 }
}

function start(){
 fetchEvents();
 timer=setInterval(fetchEvents,2000);
}

function stop(){
 clearInterval(timer);
}
</script>
</body>
</html>